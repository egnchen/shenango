
To use, compile libshim.a and the target application with it. Link the dynamic loader library (-ldl) and use the linker flag '-Wl,--wrap=main' to wrap main.
~~Make sure the application doesn't use static initializers for pthread mutexes etc.~~ Now `sync.c` is modified to be compatible with static initializers.


To compile memcached with shenango shim layer:

* Download memcached source code
* `./configure`
* Change the following lines in `Makefile`:
    * `LDFLAGS = -Wl,--wrap=main`
    * `LIBS = ../libshim.a ../../libruntime.a ../../libnet.a ../../libbase.a ../../libbpf/src/libbpf.a -T../../base/base.ld -no-pie -levent -ldl -lelf -lz`


`-no-pie` is important here, otherwise you may encounter SEGFAULT when trying to access green thread's TLS variables.